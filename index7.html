<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIT Sovereign Simulator | Final Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- THEME: DEEP SPACE COMMAND --- */
        :root {
            --bg-deep: #050608;
            --bg-panel: #0f1218;
            --rit-maroon: #800000;
            --rit-gold: #FFD700;
            --cyan: #00f3ff;
            --green: #00ff41;
            --red: #ff3333;
            --text: #e0e0e0;
            --border: 1px solid #333;
            --font-mono: 'Consolas', 'Courier New', monospace;
            --font-ui: 'Segoe UI', sans-serif;
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            background: var(--bg-deep);
            color: var(--text);
            font-family: var(--font-ui);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- HEADER --- */
        header {
            height: 60px;
            background: linear-gradient(90deg, #000 0%, var(--rit-maroon) 100%);
            border-bottom: 2px solid var(--rit-gold);
            display: flex;
            align-items: center;
            padding: 0 20px;
            justify-content: space-between;
            z-index: 100;
        }

        .brand h1 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: 800;
            color: #fff;
            letter-spacing: 1px;
        }

        .brand span {
            font-size: 0.75rem;
            color: var(--rit-gold);
            letter-spacing: 2px;
        }

        .sys-clock {
            font-family: var(--font-mono);
            color: var(--cyan);
            font-weight: bold;
        }

        /* --- NAVIGATION --- */
        nav {
            background: #111;
            display: flex;
            border-bottom: 1px solid #333;
            height: 45px;
        }

        .nav-btn {
            flex: 1;
            background: transparent;
            border: none;
            border-right: 1px solid #222;
            color: #888;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: #1a1a1a;
            color: #fff;
        }

        .nav-btn.active {
            background: var(--bg-panel);
            color: var(--cyan);
            border-bottom: 3px solid var(--cyan);
        }

        /* --- WORKSPACE --- */
        #workspace {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .section {
            display: none;
            width: 100%;
            height: 100%;
            padding: 15px;
            overflow-y: auto;
        }

        .section.active {
            display: block;
        }

        /* --- GRID LAYOUTS --- */
        .grid-dashboard {
            display: grid;
            grid-template-columns: 280px 1fr 280px;
            grid-template-rows: 1fr 200px;
            gap: 10px;
            height: 100%;
        }

        .grid-vab {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 15px;
            height: 100%;
        }

        .grid-telemetry {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 10px;
            height: 100%;
        }

        /* --- PANELS --- */
        .panel {
            background: var(--bg-panel);
            border: var(--border);
            padding: 15px;
            display: flex;
            flex-direction: column;
            border-radius: 4px;
        }

        .panel-header {
            font-size: 0.8rem;
            color: var(--rit-gold);
            font-weight: bold;
            border-bottom: 1px solid #333;
            margin-bottom: 10px;
            padding-bottom: 5px;
            text-transform: uppercase;
        }

        /* --- CONTROLS --- */
        input[type=range] {
            width: 100%;
            cursor: pointer;
            accent-color: var(--rit-maroon);
            margin: 10px 0;
        }

        select,
        input[type=number] {
            width: 100%;
            background: #000;
            color: #fff;
            border: 1px solid #444;
            padding: 6px;
            font-family: var(--font-mono);
        }

        label {
            font-size: 0.75rem;
            color: #aaa;
        }

        .btn-action {
            width: 100%;
            padding: 12px;
            border: none;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .btn-green {
            background: var(--green);
            color: #000;
        }

        .btn-green:hover {
            background: #00cc33;
        }

        .btn-red {
            background: var(--red);
            color: #fff;
        }

        .btn-red:hover {
            background: #cc0000;
        }

        .btn-blue {
            background: #222;
            color: #fff;
            border: 1px solid #444;
        }

        .btn-blue:hover {
            background: #333;
        }

        /* --- VISUALS --- */
        #sim-canvas {
            width: 100%;
            height: 100%;
            background: #000;
            display: block;
        }

        .hud-overlay {
            position: absolute;
            top: 15px;
            left: 15px;
            pointer-events: none;
            background: rgba(0, 0, 0, 0.6);
            padding: 10px;
            border-left: 3px solid var(--cyan);
        }

        .hud-val {
            font-family: var(--font-mono);
            font-size: 1.2rem;
            color: #fff;
            font-weight: bold;
        }

        .hud-label {
            font-size: 0.7rem;
            color: #aaa;
        }

        /* --- GRAPHS --- */
        .mini-chart {
            background: #080808;
            border: 1px solid #222;
            position: relative;
            width: 100%;
            height: 100%;
        }

        .chart-title {
            position: absolute;
            top: 4px;
            left: 6px;
            font-size: 0.65rem;
            color: #666;
            font-weight: bold;
            z-index: 10;
            pointer-events: none;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
        }

        /* --- FOOTER --- */
        footer {
            height: 25px;
            background: #000;
            border-top: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: #555;
        }
    </style>
</head>

<body>

    <header>
        <div class="brand">
            <h1>Ramaiah Institute of Technology</h1>
            <span>SOVEREIGN SIMULATOR V11 | DESIGNED BY DHARUN M</span>
        </div>
        <div class="sys-clock" id="clock">UTC 00:00:00</div>
    </header>

    <nav>
        <button class="nav-btn active" onclick="setMode('dashboard')"><i class="fas fa-home"></i> Dashboard</button>
        <button class="nav-btn" onclick="setMode('vab')"><i class="fas fa-tools"></i> V.A.B.</button>
        <button class="nav-btn" onclick="setMode('flight')"><i class="fas fa-rocket"></i> Flight Deck</button>
        <button class="nav-btn" onclick="setMode('telemetry')"><i class="fas fa-chart-line"></i> Telemetry Wall</button>
    </nav>

    <div id="workspace">

        <div id="sec-dashboard" class="section active" style="text-align:center; padding-top:50px;">
            <h1 style="font-size:3rem; color:var(--rit-gold);">MISSION CONTROL CENTER</h1>
            <p style="color:#888;">System Status: <span style="color:var(--green)">OPERATIONAL</span></p>

            <div style="display:flex; justify-content:center; gap:20px; margin-top:50px;">
                <div class="panel"
                    style="width:250px; align-items:center; cursor:pointer; border:1px solid var(--cyan);"
                    onclick="setMode('vab')">
                    <i class="fas fa-pencil-ruler" style="font-size:3rem; margin-bottom:20px; color:var(--cyan);"></i>
                    <h3>DESIGN VEHICLE</h3>
                </div>
                <div class="panel"
                    style="width:250px; align-items:center; cursor:pointer; border:1px solid var(--green);"
                    onclick="setMode('flight')">
                    <i class="fas fa-play-circle" style="font-size:3rem; margin-bottom:20px; color:var(--green);"></i>
                    <h3>QUICK LAUNCH</h3>
                </div>
            </div>
        </div>

        <div id="sec-vab" class="section">
            <div class="grid-vab">
                <div class="panel">
                    <div class="panel-header">ROCKET CONFIGURATION</div>

                    <label>Mission Name</label>
                    <input type="text" id="vab-name" value="RIT-SAT Mission 01" style="margin-bottom:15px;">

                    <label>First Stage Fuel (kg)</label>
                    <input type="range" min="50000" max="1000000" step="10000" value="400000" id="vab-s1"
                        oninput="VAB.update()">
                    <div style="text-align:right; color:var(--cyan); margin-bottom:10px;" id="disp-s1">400,000 kg</div>

                    <label>Second Stage Fuel (kg)</label>
                    <input type="range" min="10000" max="200000" step="1000" value="90000" id="vab-s2"
                        oninput="VAB.update()">
                    <div style="text-align:right; color:var(--cyan); margin-bottom:10px;" id="disp-s2">90,000 kg</div>

                    <label>Payload Mass (kg)</label>
                    <input type="range" min="100" max="10000" step="100" value="2000" id="vab-pay"
                        oninput="VAB.update()">
                    <div style="text-align:right; color:var(--cyan); margin-bottom:10px;" id="disp-pay">2,000 kg</div>

                    <label>Recovery Mode</label>
                    <select id="vab-reuse" onchange="VAB.update()">
                        <option value="false">Expendable (Standard)</option>
                        <option value="true">Reusable (Landing Attempt)</option>
                    </select>

                    <button class="btn-action btn-green" onclick="setMode('flight')">PROCEED TO PAD</button>
                </div>

                <div class="panel"
                    style="background:#000; align-items:center; justify-content:center; position:relative;">
                    <canvas id="blueprint-canvas"></canvas>
                    <div style="position:absolute; bottom:10px; color:#444;">VEHICLE BLUEPRINT PREVIEW</div>
                </div>
            </div>
        </div>

        <div id="sec-flight" class="section">
            <div class="grid-dashboard">
                <div class="panel">
                    <div class="panel-header">COMMAND STATION</div>
                    <div style="margin-bottom:10px; font-family:var(--font-mono);">
                        STATUS: <span id="fd-status" style="color:#fff; font-weight:bold;">READY</span><br>
                        STAGE: <span id="fd-stage" style="color:var(--rit-gold);">1</span><br>
                        TIME: <span id="fd-time">T+ 0.0s</span>
                    </div>

                    <button class="btn-action btn-green" id="btn-launch" onclick="SIM.launch()">INITIATE LAUNCH</button>
                    <button class="btn-action btn-red" onclick="SIM.abort()">ABORT</button>
                    <button class="btn-action btn-blue" onclick="SIM.reset()">RESET SIM</button>

                    <div class="panel-header" style="margin-top:20px;">CRITICAL DATA</div>
                    <div style="font-family:var(--font-mono); font-size:0.85rem; line-height:1.6;">
                        APOAPSIS: <span id="fd-apo" style="color:var(--cyan); float:right;">0.0 km</span><br>
                        PERIAPSIS: <span id="fd-peri" style="color:var(--cyan); float:right;">---</span><br>
                        DYN PRESS: <span id="fd-q" style="color:var(--cyan); float:right;">0 kPa</span><br>
                        G-FORCE: <span id="fd-g" style="color:var(--cyan); float:right;">1.00</span>
                    </div>
                </div>

                <div class="panel" style="padding:0; overflow:hidden; border:2px solid #333; grid-row: 1 / 3;">
                    <canvas id="sim-canvas"></canvas>
                    <div class="hud-overlay">
                        <div class="hud-val" id="hud-alt">0.0 km</div>
                        <div class="hud-label">ALTITUDE</div>
                        <div class="hud-val" id="hud-vel" style="margin-top:10px;">0 m/s</div>
                        <div class="hud-label">VELOCITY</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">SYSTEM HEALTH</div>
                    <div style="font-family:var(--font-mono); font-size:0.8rem;">
                        FUEL (S1): <span id="fd-fuel" style="color:var(--green); float:right;">100%</span>
                        <div style="width:100%; height:5px; background:#333; margin-top:2px;">
                            <div id="bar-fuel" style="width:100%; height:100%; background:var(--green);"></div>
                        </div>
                    </div>
                    <div style="margin-top:10px; font-family:var(--font-mono); font-size:0.8rem;">
                        THRUST: <span id="fd-thrust" style="color:var(--rit-gold); float:right;">0%</span>
                    </div>
                </div>

                <div class="panel"
                    style="grid-column: 1 / 2; grid-row: 2 / 3; background:#000; font-family:var(--font-mono); font-size:0.7rem; color:#0f0; overflow-y:auto;"
                    id="terminal">
                    <div>> SYSTEM INITIALIZED...</div>
                    <div>> WAITING FOR LAUNCH COMMAND...</div>
                </div>

                <div class="panel"
                    style="grid-column: 3 / 4; grid-row: 2 / 3; background:#001; align-items:center; justify-content:center;">
                    <div style="color:#448;">[RADAR TRACKING]</div>
                </div>
            </div>
        </div>

        <div id="sec-telemetry" class="section">
            <div class="grid-telemetry" id="telemetry-grid">
            </div>
        </div>

    </div>

    <footer>
        Â© 2025 Ramaiah Institute of Technology | Aerospace Dept | Developed by Dharun M
    </footer>

    <script>
        /**
         * ------------------------------------------------------------------
         * RIT SOVEREIGN CORE ENGINE
         * ------------------------------------------------------------------
         */

        // --- UTILITIES ---
        const $ = id => document.getElementById(id);
        const LOG = msg => {
            const term = $('terminal');
            term.innerHTML += `<div>> ${msg}</div>`;
            term.scrollTop = term.scrollHeight;
        };

        // --- SIMULATION STATE ---
        const SIM = {
            running: false,
            dt: 0.1,
            t: 0,
            config: { s1: 400000, s2: 90000, pay: 2000, reuse: false },
            state: {
                alt: 0, vel: 0, acc: 0, mass: 0, fuel: 0, stage: 1, pitch: 90,
                q: 0, thrust: 0, range: 0, apo: 0
            },

            // Launch Function
            launch: function () {
                if (this.running) return;
                this.running = true;
                this.config.s1 = parseFloat($('vab-s1').value);
                this.config.s2 = parseFloat($('vab-s2').value);
                this.config.pay = parseFloat($('vab-pay').value);
                this.config.reuse = $('vab-reuse').value === 'true';

                // Init Physics State
                this.state.mass = this.config.s1 + 25000 + this.config.s2 + 4000 + this.config.pay;
                this.state.fuel = this.config.s1;
                this.state.stage = 1;

                $('btn-launch').style.display = 'none';
                $('fd-status').innerText = "ASCENT";
                $('fd-status').style.color = "var(--green)";

                LOG("IGNITION SEQUENCE START.");
                LOG("LIFTOFF CONFIRMED!");

                requestAnimationFrame(this.loop.bind(this));
            },

            abort: function () {
                this.running = false;
                $('fd-status').innerText = "ABORTED";
                $('fd-status').style.color = "var(--red)";
                LOG("MISSION ABORTED BY USER.");
            },

            reset: function () {
                this.running = false;
                this.t = 0;
                this.state.alt = 0; this.state.vel = 0; this.state.acc = 0;
                $('btn-launch').style.display = 'block';
                $('fd-status').innerText = "READY";
                $('fd-status').style.color = "#fff";
                GRAPHS.reset();
                VISUAL.draw(this.state);
                LOG("SYSTEM RESET.");
            },

            // Main Physics Loop
            loop: function () {
                if (!this.running) return;

                const s = this.state;
                const cfg = this.config;
                const g = 9.81;

                // --- STAGING LOGIC ---
                if (s.stage === 1) {
                    if (s.fuel > 0) {
                        // S1 Burn
                        const thrust = 7600000; // 7.6 MN
                        const isp = 282;
                        const mdot = thrust / (isp * g);
                        s.fuel -= mdot * this.dt;
                        s.mass -= mdot * this.dt;
                        s.thrust = thrust;
                    } else {
                        // Separation
                        LOG("MECO. STAGE 1 SEPARATION.");
                        s.stage = 2;
                        s.mass -= 25000; // Drop dry mass
                        s.fuel = cfg.s2; // Load S2 fuel
                        if (cfg.reuse) LOG("BOOSTER RETURN MANEUVER STARTED.");
                    }
                } else if (s.stage === 2) {
                    if (s.fuel > 0) {
                        // S2 Burn
                        const thrust = 934000; // Vacuum engine
                        const isp = 348;
                        const mdot = thrust / (isp * g);

                        if (s.vel > 7500) {
                            LOG("SECO. ORBIT ACHIEVED.");
                            this.running = false;
                            $('fd-status').innerText = "ORBIT";
                            s.thrust = 0;
                        } else {
                            s.fuel -= mdot * this.dt;
                            s.mass -= mdot * this.dt;
                            s.thrust = thrust;
                        }
                    }
                }

                // --- FORCES ---
                // Gravity Turn
                if (s.alt > 1000 && s.alt < 140000) s.pitch = 90 - ((s.alt - 1000) / 140000) * 90;
                if (s.alt >= 140000) s.pitch = 0;

                const rad = s.pitch * Math.PI / 180;
                const rho = 1.225 * Math.exp(-s.alt / 8500); // Atmosphere
                s.q = 0.5 * rho * s.vel ** 2;
                const drag = s.q * 0.5 * 10; // Area 10

                const F_vert = (s.thrust * Math.sin(rad)) - (drag * Math.sin(rad)) - (s.mass * g);
                const F_horz = (s.thrust * Math.cos(rad)) - (drag * Math.cos(rad));

                const ay = F_vert / s.mass;
                const ax = F_horz / s.mass;
                s.acc = Math.sqrt(ay ** 2 + ax ** 2);

                // Integrate
                const vy = s.vel * Math.sin(rad) + ay * this.dt;
                const vx = s.vel * Math.cos(rad) + ax * this.dt;

                s.vel = Math.sqrt(vy ** 2 + vx ** 2);
                s.alt += vy * this.dt;
                this.t += this.dt;

                // --- ORBIT CALC ---
                const r = 6371000 + s.alt;
                const mu = 3.986e14;
                const E = (s.vel ** 2) / 2 - mu / r;
                const sma = -mu / (2 * E);
                s.apo = (sma * (1 + 0.01)) - 6371000;

                // --- UI UPDATE ---
                this.updateUI();
                VISUAL.draw(s);

                if (this.t % 0.5 < this.dt) GRAPHS.update(s); // Throttle graphs

                if (this.running) requestAnimationFrame(this.loop.bind(this));
            },

            updateUI: function () {
                const s = this.state;
                $('fd-time').innerText = "T+ " + this.t.toFixed(1) + "s";
                $('fd-stage').innerText = s.stage;
                $('hud-alt').innerText = (s.alt / 1000).toFixed(1) + " km";
                $('hud-vel').innerText = s.vel.toFixed(0) + " m/s";
                $('fd-apo').innerText = (s.apo / 1000).toFixed(1) + " km";
                $('fd-q').innerText = (s.q / 1000).toFixed(1) + " kPa";
                $('fd-g').innerText = (s.acc / 9.81).toFixed(2);
                $('fd-thrust').innerText = (s.thrust > 0 ? "100%" : "0%");

                // Fuel Bar
                const maxFuel = s.stage === 1 ? this.config.s1 : this.config.s2;
                const pct = (s.fuel / maxFuel) * 100;
                $('fd-fuel').innerText = pct.toFixed(0) + "%";
                $('bar-fuel').style.width = pct + "%";
            }
        };

        // --- VISUALIZER ---
        const VISUAL = {
            canvas: $('sim-canvas'),
            ctx: $('sim-canvas').getContext('2d'),
            init: function () {
                this.resize();
                window.onresize = this.resize.bind(this);
                this.draw(SIM.state);
            },
            resize: function () {
                this.canvas.width = this.canvas.parentElement.offsetWidth;
                this.canvas.height = this.canvas.parentElement.offsetHeight;
            },
            draw: function (s) {
                const ctx = this.ctx;
                const w = this.canvas.width;
                const h = this.canvas.height;

                // Sky Gradient
                let r = 0, g = 0, b = 0;
                if (s.alt < 100000) {
                    const f = 1 - (s.alt / 100000);
                    g = 50 * f; b = 100 * f;
                }
                ctx.fillStyle = `rgb(${r},${g},${b})`;
                ctx.fillRect(0, 0, w, h);

                // Stars
                if (s.alt > 30000) {
                    ctx.fillStyle = "#fff";
                    ctx.fillRect(w / 2 + 50, h / 2 - 100, 2, 2);
                    ctx.fillRect(w / 2 - 80, h / 2 - 50, 2, 2);
                }

                // Camera
                const camY = h / 2;
                const groundY = camY + (s.alt * 0.1);

                // Ground
                if (groundY > 0) {
                    ctx.fillStyle = "#004400";
                    ctx.fillRect(0, groundY, w, h);
                }

                // Rocket
                ctx.save();
                ctx.translate(w / 2, camY);
                ctx.rotate((90 - s.pitch) * Math.PI / 180);

                // Flame
                if (s.thrust > 0) {
                    ctx.fillStyle = "orange";
                    ctx.beginPath(); ctx.moveTo(-5, 20); ctx.lineTo(0, 40 + Math.random() * 20); ctx.lineTo(5, 20); ctx.fill();
                }

                // Body
                ctx.fillStyle = "#e0e0e0";
                ctx.fillRect(-8, -20, 16, 40);
                ctx.fillStyle = "#a00"; ctx.fillText("RIT", -6, 0);

                // Nose
                ctx.beginPath(); ctx.moveTo(-8, -20); ctx.lineTo(0, -40); ctx.lineTo(8, -20); ctx.fill();

                ctx.restore();
            }
        };

        // --- VAB LOGIC ---
        const VAB = {
            update: function () {
                const s1 = parseFloat($('vab-s1').value);
                const s2 = parseFloat($('vab-s2').value);
                $('disp-s1').innerText = s1.toLocaleString() + " kg";
                $('disp-s2').innerText = s2.toLocaleString() + " kg";
                this.draw();
            },
            draw: function () {
                const c = $('blueprint-canvas');
                const ctx = c.getContext('2d');
                c.width = c.parentElement.offsetWidth; c.height = c.parentElement.offsetHeight;

                const cx = c.width / 2;
                const base = c.height - 20;

                // Draw Schematic
                const h1 = parseFloat($('vab-s1').value) / 3000;
                const h2 = parseFloat($('vab-s2').value) / 3000;

                ctx.strokeStyle = "#fff"; ctx.lineWidth = 2;
                ctx.strokeRect(cx - 20, base - h1, 40, h1); // S1
                ctx.strokeRect(cx - 20, base - h1 - h2, 40, h2); // S2

                // Payload
                ctx.beginPath(); ctx.moveTo(cx - 20, base - h1 - h2); ctx.lineTo(cx, base - h1 - h2 - 40); ctx.lineTo(cx + 20, base - h1 - h2); ctx.stroke();
            }
        };

        // --- GRAPHS (TELEMETRY WALL) ---
        const GRAPHS = {
            titles: ['Altitude', 'Velocity', 'Accel', 'Q', 'Mass', 'Thrust', 'Pitch', 'AoA', 'Range', 'Drag', 'Flow', 'ISP', 'Gravity', 'Heat', 'Ecc', 'Energy'],
            charts: [],
            init: function () {
                const grid = $('telemetry-grid');
                this.titles.forEach((t, i) => {
                    const div = document.createElement('div');
                    div.className = 'mini-chart';
                    div.innerHTML = `<div class="chart-title">${t}</div><canvas id="chart-${i}"></canvas>`;
                    grid.appendChild(div);

                    const ctx = document.getElementById(`chart-${i}`).getContext('2d');
                    this.charts.push(new Chart(ctx, {
                        type: 'line',
                        data: { labels: [], datasets: [{ data: [], borderColor: '#00f3ff', borderWidth: 1, pointRadius: 0 }] },
                        options: { responsive: true, maintainAspectRatio: false, animation: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { grid: { color: '#222' } } } }
                    }));
                });
            },
            update: function (s) {
                const dataMap = [s.alt / 1000, s.vel, s.acc / 9.81, s.q / 1000, s.mass / 1000, s.thrust / 1000, s.pitch, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                const label = SIM.t.toFixed(0);

                this.charts.forEach((c, i) => {
                    c.data.labels.push(label);
                    c.data.datasets[0].data.push(dataMap[i]);
                    if (c.data.labels.length > 30) { c.data.labels.shift(); c.data.datasets[0].data.shift(); }
                    c.update('none');
                });
            },
            reset: function () {
                this.charts.forEach(c => { c.data.labels = []; c.data.datasets[0].data = []; c.update(); });
            }
        };

        // --- APP INIT ---
        function setMode(mode) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            $('sec-' + mode).classList.add('active');
            event.currentTarget.classList.add('active');
            if (mode === 'vab') VAB.update();
        }

        window.onload = function () {
            setInterval(() => { $('clock').innerText = "UTC " + new Date().toISOString().split('T')[1].split('.')[0]; }, 1000);
            VISUAL.init();
            GRAPHS.init();
            VAB.update();
            LOG("SYSTEM READY.");
        };

    </script>
</body>

</html>